/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, forwardRef, Input } from '@angular/core';
import * as THREE from 'three';
import { AbstractObject3D } from '../abstract-object-3d';
import { MeshLine, MeshLineMaterial } from 'three.meshline';
import { AbstractConnector } from './abstract-connector';
import { appliedColor } from '../../util/applied-color';
import { AnimationService } from '../../animation/animation.service';
import { RendererService } from '../../renderer/renderer.service';
var MeshLineConnectorComponent = /** @class */ (function (_super) {
    tslib_1.__extends(MeshLineConnectorComponent, _super);
    function MeshLineConnectorComponent(animationService, rendererService) {
        var _this = _super.call(this, rendererService) || this;
        _this.animationService = animationService;
        _this.rendererService = rendererService;
        _this.materialColor = 0xffff00;
        _this.transparent = true;
        _this.opacity = 0.5;
        _this.lineWidth = 0.5;
        _this.depthWrite = true;
        _this.depthTest = true;
        _this.animated = false;
        _this.animationIncrement = 0.002;
        return _this;
    }
    /**
     * @return {?}
     */
    MeshLineConnectorComponent.prototype.createConnectorObject = /**
     * @return {?}
     */
    function () {
        this.geometry = this.getLineGeometry();
        this.line = new MeshLine();
        this.line.setGeometry(this.geometry);
        this.lineMaterial = (this.animated ?
            new MeshLineMaterial({
                color: appliedColor(this.materialColor),
                transparent: this.transparent,
                opacity: this.opacity,
                lineWidth: this.lineWidth,
                depthWrite: this.depthWrite,
                depthTest: this.depthTest,
                side: THREE.DoubleSide,
                blending: THREE.NormalBlending,
                // TODO: props
                dashArray: 0.05,
                dashOffset: 0.1,
                dashRatio: 0.1
            })
            : new MeshLineMaterial({
                color: appliedColor(this.materialColor),
                transparent: this.transparent,
                opacity: this.opacity,
                lineWidth: this.lineWidth,
                depthWrite: this.depthWrite,
                depthTest: this.depthTest,
                side: THREE.DoubleSide,
                blending: THREE.NormalBlending
            }));
        /** @type {?} */
        var mesh = new THREE.Mesh(this.line.geometry, this.lineMaterial);
        if (this.animated) {
            this.animate = this.animate.bind(this);
            this.animationService.animate.subscribe(this.animate);
        }
        return mesh;
    };
    /**
     * @private
     * @return {?}
     */
    MeshLineConnectorComponent.prototype.animate = /**
     * @private
     * @return {?}
     */
    function () {
        this.lineMaterial.uniforms.dashOffset.value += this.animationIncrement;
    };
    /**
     * @return {?}
     */
    MeshLineConnectorComponent.prototype.updateLineGeometry = /**
     * @return {?}
     */
    function () {
        // https://github.com/spite/THREE.MeshLine/issues/51#issuecomment-379579926
        this.line.setGeometry(this.geometry);
        this.rendererService.render();
    };
    MeshLineConnectorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'atft-mesh-line-connector',
                    providers: [{ provide: AbstractObject3D, useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return MeshLineConnectorComponent; })) }],
                    template: '<ng-content></ng-content>'
                }] }
    ];
    /** @nocollapse */
    MeshLineConnectorComponent.ctorParameters = function () { return [
        { type: AnimationService },
        { type: RendererService }
    ]; };
    MeshLineConnectorComponent.propDecorators = {
        materialColor: [{ type: Input }],
        transparent: [{ type: Input }],
        opacity: [{ type: Input }],
        lineWidth: [{ type: Input }],
        depthWrite: [{ type: Input }],
        depthTest: [{ type: Input }],
        animated: [{ type: Input }],
        animationIncrement: [{ type: Input }]
    };
    return MeshLineConnectorComponent;
}(AbstractConnector));
export { MeshLineConnectorComponent };
if (false) {
    /** @type {?} */
    MeshLineConnectorComponent.prototype.materialColor;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.transparent;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.opacity;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.lineWidth;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.depthWrite;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.depthTest;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.animated;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.animationIncrement;
    /**
     * @type {?}
     * @private
     */
    MeshLineConnectorComponent.prototype.geometry;
    /**
     * @type {?}
     * @private
     */
    MeshLineConnectorComponent.prototype.line;
    /**
     * @type {?}
     * @private
     */
    MeshLineConnectorComponent.prototype.lineMaterial;
    /**
     * @type {?}
     * @protected
     */
    MeshLineConnectorComponent.prototype.animationService;
    /**
     * @type {?}
     * @protected
     */
    MeshLineConnectorComponent.prototype.rendererService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzaC1saW5lLWNvbm5lY3Rvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hdGZ0LyIsInNvdXJjZXMiOlsibGliL29iamVjdC9jb25uZWN0b3IvbWVzaC1saW5lLWNvbm5lY3Rvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDM0QsT0FBTyxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUM7QUFDL0IsT0FBTyxFQUFDLGdCQUFnQixFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFDdkQsT0FBTyxFQUFDLFFBQVEsRUFBRSxnQkFBZ0IsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzFELE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHNCQUFzQixDQUFDO0FBQ3ZELE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUN0RCxPQUFPLEVBQUMsZ0JBQWdCLEVBQUMsTUFBTSxtQ0FBbUMsQ0FBQztBQUNuRSxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0saUNBQWlDLENBQUM7QUFFaEU7SUFLZ0Qsc0RBQTZCO0lBOEIzRSxvQ0FDWSxnQkFBa0MsRUFDbEMsZUFBZ0M7UUFGNUMsWUFJRSxrQkFBTSxlQUFlLENBQUMsU0FDdkI7UUFKVyxzQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQ2xDLHFCQUFlLEdBQWYsZUFBZSxDQUFpQjtRQTdCNUMsbUJBQWEsR0FBRyxRQUFRLENBQUM7UUFHekIsaUJBQVcsR0FBRyxJQUFJLENBQUM7UUFHbkIsYUFBTyxHQUFHLEdBQUcsQ0FBQztRQUdkLGVBQVMsR0FBRyxHQUFHLENBQUM7UUFHaEIsZ0JBQVUsR0FBRyxJQUFJLENBQUM7UUFHbEIsZUFBUyxHQUFHLElBQUksQ0FBQztRQUdqQixjQUFRLEdBQUcsS0FBSyxDQUFDO1FBRVIsd0JBQWtCLEdBQUcsS0FBSyxD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SztxQ0FHTCxLQUFLOztJQWlFUixpQ0FBQztDQUFBLEFBN0ZELENBS2dELGlCQUFpQixHQXdGaEU7U0F4RlksMEJBQTBCOzs7SUFFckMsbURBQ3lCOztJQUV6QixpREFDbUI7O0lBRW5CLDZDQUNjOztJQUVkLCtDQUNnQjs7SUFFaEIsZ0RBQ2tCOztJQUVsQiwrQ0FDaUI7O0lBRWpCLDhDQUNpQjs7SUFFakIsd0RBQW9DOzs7OztJQUVwQyw4Q0FBaUM7Ozs7O0lBQ2pDLDBDQUF1Qjs7Ozs7SUFDdkIsa0RBQXVDOzs7OztJQUlyQyxzREFBNEM7Ozs7O0lBQzVDLHFEQUEwQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBmb3J3YXJkUmVmLCBJbnB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJztcclxuaW1wb3J0IHtBYnN0cmFjdE9iamVjdDNEfSBmcm9tICcuLi9hYnN0cmFjdC1vYmplY3QtM2QnO1xyXG5pbXBvcnQge01lc2hMaW5lLCBNZXNoTGluZU1hdGVyaWFsfSBmcm9tICd0aHJlZS5tZXNobGluZSc7XHJcbmltcG9ydCB7QWJzdHJhY3RDb25uZWN0b3J9IGZyb20gJy4vYWJzdHJhY3QtY29ubmVjdG9yJztcclxuaW1wb3J0IHthcHBsaWVkQ29sb3J9IGZyb20gJy4uLy4uL3V0aWwvYXBwbGllZC1jb2xvcic7XHJcbmltcG9ydCB7QW5pbWF0aW9uU2VydmljZX0gZnJvbSAnLi4vLi4vYW5pbWF0aW9uL2FuaW1hdGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHtSZW5kZXJlclNlcnZpY2V9IGZyb20gJy4uLy4uL3JlbmRlcmVyL3JlbmRlcmVyLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhdGZ0LW1lc2gtbGluZS1jb25uZWN0b3InLFxyXG4gIHByb3ZpZGVyczogW3twcm92aWRlOiBBYnN0cmFjdE9iamVjdDNELCB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNZXNoTGluZUNvbm5lY3RvckNvbXBvbmVudCl9XSxcclxuICB0ZW1wbGF0ZTogJzxuZy1jb250ZW50PjwvbmctY29udGVudD4nXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBNZXNoTGluZUNvbm5lY3RvckNvbXBvbmVudCBleHRlbmRzIEFic3RyYWN0Q29ubmVjdG9yPFRIUkVFLk1lc2g+IHtcclxuXHJcbiAgQElucHV0KClcclxuICBtYXRlcmlhbENvbG9yID0gMHhmZmZmMDA7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgdHJhbnNwYXJlbnQgPSB0cnVlO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIG9wYWNpdHkgPSAwLjU7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgbGluZVdpZHRoID0gMC41O1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGRlcHRoV3JpdGUgPSB0cnVlO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGRlcHRoVGVzdCA9IHRydWU7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgYW5pbWF0ZWQgPSBmYWxzZTtcclxuXHJcbiAgQElucHV0KCkgYW5pbWF0aW9uSW5jcmVtZW50ID0gMC4wMDI7XHJcblxyXG4gIHByaXZhdGUgZ2VvbWV0cnk6IFRIUkVFLkdlb21ldHJ5O1xyXG4gIHByaXZhdGUgbGluZTogTWVzaExpbmU7XHJcbiAgcHJpdmF0ZSBsaW5lTWF0ZXJpYWw6IE1lc2hMaW5lTWF0ZXJpYWw7XHJcblxyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByb3RlY3RlZCBhbmltYXRpb25TZXJ2aWNlOiBBbmltYXRpb25TZXJ2aWNlLFxyXG4gICAgcHJvdGVjdGVkIHJlbmRlcmVyU2VydmljZTogUmVuZGVyZXJTZXJ2aWNlXHJcbiAgKSB7XHJcbiAgICBzdXBlcihyZW5kZXJlclNlcnZpY2UpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ29ubmVjdG9yT2JqZWN0KCk6IFRIUkVFLk1lc2gge1xyXG4gICAgdGhpcy5nZW9tZXRyeSA9IHRoaXMuZ2V0TGluZUdlb21ldHJ5KCk7XHJcblxyXG4gICAgdGhpcy5saW5lID0gbmV3IE1lc2hMaW5lKCk7XHJcbiAgICB0aGlzLmxpbmUuc2V0R2VvbWV0cnkodGhpcy5nZW9tZXRyeSk7XHJcblxyXG4gICAgdGhpcy5saW5lTWF0ZXJpYWwgPSAodGhpcy5hbmltYXRlZCA/XHJcbiAgICAgICAgbmV3IE1lc2hMaW5lTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgY29sb3I6IGFwcGxpZWRDb2xvcih0aGlzLm1hdGVyaWFsQ29sb3IpLFxyXG4gICAgICAgICAgdHJhbnNwYXJlbnQ6IHRoaXMudHJhbnNwYXJlbnQsXHJcbiAgICAgICAgICBvcGFjaXR5OiB0aGlzLm9wYWNpdHksXHJcbiAgICAgICAgICBsaW5lV2lkdGg6IHRoaXMubGluZVdpZHRoLFxyXG4gICAgICAgICAgZGVwdGhXcml0ZTogdGhpcy5kZXB0aFdyaXRlLFxyXG4gICAgICAgICAgZGVwdGhUZXN0OiB0aGlzLmRlcHRoVGVzdCxcclxuICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsXHJcbiAgICAgICAgICBibGVuZGluZzogVEhSRUUuTm9ybWFsQmxlbmRpbmcsXHJcbiAgICAgICAgICAvLyBUT0RPOiBwcm9wc1xyXG4gICAgICAgICAgZGFzaEFycmF5OiAwLjA1LFxyXG4gICAgICAgICAgZGFzaE9mZnNldDogMC4xLFxyXG4gICAgICAgICAgZGFzaFJhdGlvOiAwLjFcclxuICAgICAgICB9KVxyXG4gICAgICAgIDogbmV3IE1lc2hMaW5lTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgY29sb3I6IGFwcGxpZWRDb2xvcih0aGlzLm1hdGVyaWFsQ29sb3IpLFxyXG4gICAgICAgICAgdHJhbnNwYXJlbnQ6IHRoaXMudHJhbnNwYXJlbnQsXHJcbiAgICAgICAgICBvcGFjaXR5OiB0aGlzLm9wYWNpdHksXHJcbiAgICAgICAgICBsaW5lV2lkdGg6IHRoaXMubGluZVdpZHRoLFxyXG4gICAgICAgICAgZGVwdGhXcml0ZTogdGhpcy5kZXB0aFdyaXRlLFxyXG4gICAgICAgICAgZGVwdGhUZXN0OiB0aGlzLmRlcHRoVGVzdCxcclxuICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsXHJcbiAgICAgICAgICBibGVuZGluZzogVEhSRUUuTm9ybWFsQmxlbmRpbmdcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2godGhpcy5saW5lLmdlb21ldHJ5LCB0aGlzLmxpbmVNYXRlcmlhbCk7XHJcbiAgICBpZiAodGhpcy5hbmltYXRlZCkge1xyXG4gICAgICB0aGlzLmFuaW1hdGUgPSB0aGlzLmFuaW1hdGUuYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5hbmltYXRpb25TZXJ2aWNlLmFuaW1hdGUuc3Vic2NyaWJlKHRoaXMuYW5pbWF0ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVzaDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYW5pbWF0ZSgpIHtcclxuICAgIHRoaXMubGluZU1hdGVyaWFsLnVuaWZvcm1zLmRhc2hPZmZzZXQudmFsdWUgKz0gdGhpcy5hbmltYXRpb25JbmNyZW1lbnQ7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaW5lR2VvbWV0cnkoKTogdm9pZCB7XHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc3BpdGUvVEhSRUUuTWVzaExpbmUvaXNzdWVzLzUxI2lzc3VlY29tbWVudC0zNzk1Nzk5MjZcclxuICAgIHRoaXMubGluZS5zZXRHZW9tZXRyeSh0aGlzLmdlb21ldHJ5KTtcclxuICAgIHRoaXMucmVuZGVyZXJTZXJ2aWNlLnJlbmRlcigpO1xyXG4gIH1cclxuXHJcbn1cclxuIl19