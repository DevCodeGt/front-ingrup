/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ContentChildren, EventEmitter, Input, Output, QueryList, ViewChildren } from '@angular/core';
/**
 * @abstract
 * @template T
 */
var AbstractObject3D = /** @class */ (function () {
    function AbstractObject3D(rendererService) {
        var _this = this;
        this.rendererService = rendererService;
        this.changed = new EventEmitter();
        // console.log('AbstractObject3D.constructor');
        this.changed.subscribe((/**
         * @return {?}
         */
        function () {
            _this.rendererService.render();
        }));
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    AbstractObject3D.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (!this.object) {
            return;
        }
        /** @type {?} */
        var modified = false;
        if (['rotateX', 'rotateY', 'rotateZ'].some((/**
         * @param {?} propName
         * @return {?}
         */
        function (propName) { return propName in changes; }))) {
            this.applyRotation();
            modified = true;
        }
        if (['translateX', 'translateY', 'translateZ'].some((/**
         * @param {?} propName
         * @return {?}
         */
        function (propName) { return propName in changes; }))) {
            this.applyTranslation();
            modified = true;
        }
        if (modified) {
            this.changed.emit();
        }
    };
    /**
     * @return {?}
     */
    AbstractObject3D.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        // console.log('AbstractObject3D.OnDestroy');
        if (this.object && this.object.parent) {
            this.object.parent.remove(this.object);
        }
    };
    /**
     * @return {?}
     */
    AbstractObject3D.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        // console.log('AbstractObject3D.ngAfterViewInit ' + this.name);
        this.object = this.newObject3DInstance();
        this.applyTranslation();
        this.applyRotation();
        this.collectChilds();
        this.afterInit();
    };
    /**
     * @return {?}
     */
    AbstractObject3D.prototype.collectChilds = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // console.log('Collect childs for', this.name);
        if (this.childNodes !== undefined && this.childNodes.length > 1) {
            this.childNodes.filter((/**
             * @param {?} i
             * @return {?}
             */
            function (i) { return i !== _this && i.getObject() !== undefined; })).forEach((/**
             * @param {?} i
             * @return {?}
             */
            function (i) {
                // console.log('Add childNodes for', this.name, i);
                _this.addChild(i.getObject());
            }));
        }
        else {
            // console.log("No child Object3D for: " + this.constructor.label);
        }
        if (this.viewChilds !== undefined && this.viewChilds.length > 0) {
            this.viewChilds.filter((/**
             * @param {?} i
             * @return {?}
             */
            function (i) { return i !== _this
                && i.getObject() !== undefined
                && !i.getObject().parent; } /* direct childs only */)).forEach((/**
             * @param {?} i
             * @return {?}
             */
            function (i) {
                // console.log('Add viewChilds for', this.name, i);
                _this.addChild(i.getObject());
            }));
        }
        else {
            // console.log("No child Object3D for: " + this.constructor.label);
        }
    };
    /**
     * @private
     * @return {?}
     */
    AbstractObject3D.prototype.applyRotation = /**
     * @private
     * @return {?}
     */
    function () {
        this.object.rotation.set(this.rotateX || 0, this.rotateY || 0, this.rotateZ || 0, 'XYZ');
    };
    /**
     * @private
     * @return {?}
     */
    AbstractObject3D.prototype.applyTranslation = /**
     * @private
     * @return {?}
     */
    function () {
        this.object.position.set(this.translateX || 0, this.translateY || 0, this.translateZ || 0);
    };
    /**
     * @param {?} object
     * @return {?}
     */
    AbstractObject3D.prototype.addChild = /**
     * @param {?} object
     * @return {?}
     */
    function (object) {
        this.object.add(object);
    };
    /**
     * @protected
     * @param {?} object
     * @return {?}
     */
    AbstractObject3D.prototype.removeChild = /**
     * @protected
     * @param {?} object
     * @return {?}
     */
    function (object) {
        this.object.remove(object);
    };
    /**
     * @return {?}
     */
    AbstractObject3D.prototype.getObject = /**
     * @return {?}
     */
    function () {
        return this.object;
    };
    /**
     * @protected
     * @return {?}
     */
    AbstractObject3D.prototype.afterInit = /**
     * @protected
     * @return {?}
     */
    function () {
        // this.changed.emit();
    };
    AbstractObject3D.propDecorators = {
        childNodes: [{ type: ContentChildren, args: [AbstractObject3D, { descendants: false },] }],
        viewChilds: [{ type: ViewChildren, args: [AbstractObject3D,] }],
        rotateX: [{ type: Input }],
        rotateY: [{ type: Input }],
        rotateZ: [{ type: Input }],
        translateX: [{ type: Input }],
        translateY: [{ type: Input }],
        translateZ: [{ type: Input }],
        name: [{ type: Input }],
        changed: [{ type: Output }]
    };
    return AbstractObject3D;
}());
export { AbstractObject3D };
if (false) {
    /** @type {?} */
    AbstractObject3D.prototype.childNodes;
    /** @type {?} */
    AbstractObject3D.prototype.viewChilds;
    /**
     * Rotation in Euler angles (radians) with order X, Y, Z.
     * @type {?}
     */
    AbstractObject3D.prototype.rotateX;
    /** @type {?} */
    AbstractObject3D.prototype.rotateY;
    /** @type {?} */
    AbstractObject3D.prototype.rotateZ;
    /**
     * Translate the geometry. This is typically done as a one time operation, and not during a loop.
     * @type {?}
     */
    AbstractObject3D.prototype.translateX;
    /** @type {?} */
    AbstractObject3D.prototype.translateY;
    /** @type {?} */
    AbstractObject3D.prototype.translateZ;
    /** @type {?} */
    AbstractObject3D.prototype.name;
    /** @type {?} */
    AbstractObject3D.prototype.changed;
    /**
     * @type {?}
     * @private
     */
    AbstractObject3D.prototype.object;
    /**
     * @type {?}
     * @protected
     */
    AbstractObject3D.prototype.rendererService;
    /**
     * @abstract
     * @protected
     * @return {?}
     */
    AbstractObject3D.prototype.newObject3DInstance = function () { };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWJzdHJhY3Qtb2JqZWN0LTNkLmpzIiwic291cmNlUm9vdCI6Im5nOi8vYXRmdC8iLCJzb3VyY2VzIjpbImxpYi9vYmplY3QvYWJzdHJhY3Qtb2JqZWN0LTNkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBRUwsZUFBZSxFQUNmLFlBQVksRUFDWixLQUFLLEVBR0wsTUFBTSxFQUNOLFNBQVMsRUFFVCxZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7Ozs7O0FBSXZCO0lBMEJFLDBCQUFzQixlQUFnQztRQUF0RCxpQkFNQztRQU5xQixvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFKNUMsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFRLENBQUM7UUFLM0MsK0NBQStDO1FBQy9DLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUzs7O1FBQUM7WUFDckIsS0FBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNoQyxDQUFDLEVBQUMsQ0FBQztJQUVMLENBQUM7Ozs7O0lBRU0sc0NBQVc7Ozs7SUFBbEIsVUFBbUIsT0FBc0I7UUFDdkMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDaEIsT0FBTztTQUNSOztZQUVHLFFBQVEsR0FBRyxLQUFLO1FBRXBCLElBQUksQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDLElBQUk7Ozs7UUFBQyxVQUFBLFFBQVEsSUFBSSxPQUFBLFFBQVEsSUFBSSxPQUFPLEVBQW5CLENBQW1CLEVBQUMsRUFBRTtZQUMzRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDckIsUUFBUSxHQUFHLElBQUksQ0FBQztTQUNqQjtRQUNELElBQUksQ0FBQyxZQUFZLEVBQUUsWUFBWSxFQUFFLFlBQVksQ0FBQyxDQUFDLElBQUk7Ozs7UUFBQyxVQUFBLFFBQVEsSUFBSSxPQUFBLFFBQVEsSUFBSSxPQUFPLEVBQW5CLENBQW1CLEVBQUMsRUFBRTtZQUNwRixJQUFJLENBQUMsZ0JBQWdCLEVB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MUIsQ0FBQzs7Ozs7O0lBRVMsc0NBQVc7Ozs7O0lBQXJCLFVBQXNCLE1BQXNCO1FBQzFDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzdCLENBQUM7Ozs7SUFFTSxvQ0FBUzs7O0lBQWhCO1FBQ0UsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3JCLENBQUM7Ozs7O0lBRVMsb0NBQVM7Ozs7SUFBbkI7UUFDRSx1QkFBdUI7SUFDekIsQ0FBQzs7NkJBcElBLGVBQWUsU0FBQyxnQkFBZ0IsRUFBRSxFQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUM7NkJBRXRELFlBQVksU0FBQyxnQkFBZ0I7MEJBSzdCLEtBQUs7MEJBQ0wsS0FBSzswQkFDTCxLQUFLOzZCQUtMLEtBQUs7NkJBQ0wsS0FBSzs2QkFDTCxLQUFLO3VCQUVMLEtBQUs7MEJBRUwsTUFBTTs7SUFxSFQsdUJBQUM7Q0FBQSxBQTNJRCxJQTJJQztTQTNJcUIsZ0JBQWdCOzs7SUFFcEMsc0NBQWlIOztJQUVqSCxzQ0FBd0Y7Ozs7O0lBS3hGLG1DQUF5Qjs7SUFDekIsbUNBQXlCOztJQUN6QixtQ0FBeUI7Ozs7O0lBS3pCLHNDQUE0Qjs7SUFDNUIsc0NBQTRCOztJQUM1QixzQ0FBNEI7O0lBRTVCLGdDQUFzQjs7SUFFdEIsbUNBQTZDOzs7OztJQUU3QyxrQ0FBa0I7Ozs7O0lBRU4sMkNBQTBDOzs7Ozs7SUE4R3RELGlFQUE0QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQWZ0ZXJWaWV3SW5pdCxcclxuICBDb250ZW50Q2hpbGRyZW4sXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIElucHV0LFxyXG4gIE9uQ2hhbmdlcyxcclxuICBPbkRlc3Ryb3ksXHJcbiAgT3V0cHV0LFxyXG4gIFF1ZXJ5TGlzdCxcclxuICBTaW1wbGVDaGFuZ2VzLFxyXG4gIFZpZXdDaGlsZHJlblxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7XHJcbmltcG9ydCB7UmVuZGVyZXJTZXJ2aWNlfSBmcm9tICcuLi9yZW5kZXJlci9yZW5kZXJlci5zZXJ2aWNlJztcclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdE9iamVjdDNEPFQgZXh0ZW5kcyBUSFJFRS5PYmplY3QzRD4gaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XHJcblxyXG4gIEBDb250ZW50Q2hpbGRyZW4oQWJzdHJhY3RPYmplY3QzRCwge2Rlc2NlbmRhbnRzOiBmYWxzZX0pIGNoaWxkTm9kZXM6IFF1ZXJ5TGlzdDxBYnN0cmFjdE9iamVjdDNEPFRIUkVFLk9iamVjdDNEPj47XHJcblxyXG4gIEBWaWV3Q2hpbGRyZW4oQWJzdHJhY3RPYmplY3QzRCkgdmlld0NoaWxkczogUXVlcnlMaXN0PEFic3RyYWN0T2JqZWN0M0Q8VEhSRUUuT2JqZWN0M0Q+PjtcclxuXHJcbiAgLyoqXHJcbiAgICogUm90YXRpb24gaW4gRXVsZXIgYW5nbGVzIChyYWRpYW5zKSB3aXRoIG9yZGVyIFgsIFksIFouXHJcbiAgICovXHJcbiAgQElucHV0KCkgcm90YXRlWDogbnVtYmVyO1xyXG4gIEBJbnB1dCgpIHJvdGF0ZVk6IG51bWJlcjtcclxuICBASW5wdXQoKSByb3RhdGVaOiBudW1iZXI7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRyYW5zbGF0ZSB0aGUgZ2VvbWV0cnkuIFRoaXMgaXMgdHlwaWNhbGx5IGRvbmUgYXMgYSBvbmUgdGltZSBvcGVyYXRpb24sIGFuZCBub3QgZHVyaW5nIGEgbG9vcC5cclxuICAgKi9cclxuICBASW5wdXQoKSB0cmFuc2xhdGVYOiBudW1iZXI7XHJcbiAgQElucHV0KCkgdHJhbnNsYXRlWTogbnVtYmVyO1xyXG4gIEBJbnB1dCgpIHRyYW5zbGF0ZVo6IG51bWJlcjtcclxuXHJcbiAgQElucHV0KCkgbmFtZTogc3RyaW5nO1xyXG5cclxuICBAT3V0cHV0KCkgY2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuXHJcbiAgcHJpdmF0ZSBvYmplY3Q6IFQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCByZW5kZXJlclNlcnZpY2U6IFJlbmRlcmVyU2VydmljZSkge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ0Fic3RyYWN0T2JqZWN0M0QuY29uc3RydWN0b3InKTtcclxuICAgIHRoaXMuY2hhbmdlZC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyU2VydmljZS5yZW5kZXIoKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICBpZiAoIXRoaXMub2JqZWN0KSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcclxuXHJcbiAgICBpZiAoWydyb3RhdGVYJywgJ3JvdGF0ZVknLCAncm90YXRlWiddLnNvbWUocHJvcE5hbWUgPT4gcHJvcE5hbWUgaW4gY2hhbmdlcykpIHtcclxuICAgICAgdGhpcy5hcHBseVJvdGF0aW9uKCk7XHJcbiAgICAgIG1vZGlmaWVkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGlmIChbJ3RyYW5zbGF0ZVgnLCAndHJhbnNsYXRlWScsICd0cmFuc2xhdGVaJ10uc29tZShwcm9wTmFtZSA9PiBwcm9wTmFtZSBpbiBjaGFuZ2VzKSkge1xyXG4gICAgICB0aGlzLmFwcGx5VHJhbnNsYXRpb24oKTtcclxuICAgICAgbW9kaWZpZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChtb2RpZmllZCkge1xyXG4gICAgICB0aGlzLmNoYW5nZWQuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ09uRGVzdHJveSgpIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdBYnN0cmFjdE9iamVjdDNELk9uRGVzdHJveScpO1xyXG4gICAgaWYgKHRoaXMub2JqZWN0ICYmIHRoaXMub2JqZWN0LnBhcmVudCkge1xyXG4gICAgICB0aGlzLm9iamVjdC5wYXJlbnQucmVtb3ZlKHRoaXMub2JqZWN0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnQWJzdHJhY3RPYmplY3QzRC5uZ0FmdGVyVmlld0luaXQgJyArIHRoaXMubmFtZSk7XHJcbiAgICB0aGlzLm9iamVjdCA9IHRoaXMubmV3T2JqZWN0M0RJbnN0YW5jZSgpO1xyXG5cclxuICAgIHRoaXMuYXBwbHlUcmFuc2xhdGlvbigpO1xyXG4gICAgdGhpcy5hcHBseVJvdGF0aW9uKCk7XHJcblxyXG4gICAgdGhpcy5jb2xsZWN0Q2hpbGRzKCk7XHJcblxyXG4gICAgdGhpcy5hZnRlckluaXQoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjb2xsZWN0Q2hpbGRzKCkge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ0NvbGxlY3QgY2hpbGRzIGZvcicsIHRoaXMubmFtZSk7XHJcbiAgICBpZiAodGhpcy5jaGlsZE5vZGVzICE9PSB1bmRlZmluZWQgJiYgdGhpcy5jaGlsZE5vZGVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgdGhpcy5jaGlsZE5vZGVzLmZpbHRlcihpID0+IGkgIT09IHRoaXMgJiYgaS5nZXRPYmplY3QoKSAhPT0gdW5kZWZpbmVkKS5mb3JFYWNoKGkgPT4ge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdBZGQgY2hpbGROb2RlcyBmb3InLCB0aGlzLm5hbWUsIGkpO1xyXG4gICAgICAgIHRoaXMuYWRkQ2hpbGQoaS5nZXRPYmplY3QoKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gY29uc29sZS5sb2coXCJObyBjaGlsZCBPYmplY3QzRCBmb3I6IFwiICsgdGhpcy5jb25zdHJ1Y3Rvci5sYWJlbCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGlmICh0aGlzLnZpZXdDaGlsZHMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnZpZXdDaGlsZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLnZpZXdDaGlsZHMuZmlsdGVyKFxyXG4gICAgICAgIGkgPT4gaSAhPT0gdGhpc1xyXG4gICAgICAgICAgJiYgaS5nZXRPYmplY3QoKSAhPT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAmJiAhaS5nZXRPYmplY3QoKS5wYXJlbnQgLyogZGlyZWN0IGNoaWxkcyBvbmx5ICovXHJcbiAgICAgICkuZm9yRWFjaChpID0+IHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnQWRkIHZpZXdDaGlsZHMgZm9yJywgdGhpcy5uYW1lLCBpKTtcclxuICAgICAgICB0aGlzLmFkZENoaWxkKGkuZ2V0T2JqZWN0KCkpO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwiTm8gY2hpbGQgT2JqZWN0M0QgZm9yOiBcIiArIHRoaXMuY29uc3RydWN0b3IubGFiZWwpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG5cclxuICBwcml2YXRlIGFwcGx5Um90YXRpb24oKTogdm9pZCB7XHJcbiAgICB0aGlzLm9iamVjdC5yb3RhdGlvbi5zZXQoXHJcbiAgICAgIHRoaXMucm90YXRlWCB8fCAwLFxyXG4gICAgICB0aGlzLnJvdGF0ZVkgfHwgMCxcclxuICAgICAgdGhpcy5yb3RhdGVaIHx8IDAsXHJcbiAgICAgICdYWVonXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhcHBseVRyYW5zbGF0aW9uKCk6IHZvaWQge1xyXG4gICAgdGhpcy5vYmplY3QucG9zaXRpb24uc2V0KFxyXG4gICAgICB0aGlzLnRyYW5zbGF0ZVggfHwgMCxcclxuICAgICAgdGhpcy50cmFuc2xhdGVZIHx8IDAsXHJcbiAgICAgIHRoaXMudHJhbnNsYXRlWiB8fCAwXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGFkZENoaWxkKG9iamVjdDogVEhSRUUuT2JqZWN0M0QpOiB2b2lkIHtcclxuICAgIHRoaXMub2JqZWN0LmFkZChvYmplY3QpO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIHJlbW92ZUNoaWxkKG9iamVjdDogVEhSRUUuT2JqZWN0M0QpOiB2b2lkIHtcclxuICAgIHRoaXMub2JqZWN0LnJlbW92ZShvYmplY3QpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldE9iamVjdCgpOiBUIHtcclxuICAgIHJldHVybiB0aGlzLm9iamVjdDtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBhZnRlckluaXQoKSB7XHJcbiAgICAvLyB0aGlzLmNoYW5nZWQuZW1pdCgpO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGFic3RyYWN0IG5ld09iamVjdDNESW5zdGFuY2UoKTogVDtcclxuXHJcblxyXG59XHJcbiJdfQ==