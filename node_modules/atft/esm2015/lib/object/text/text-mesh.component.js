/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, forwardRef, Input } from '@angular/core';
import * as THREE from 'three';
import { AbstractObject3D } from '../abstract-object-3d';
import { AbstractLazyObject3D } from '../abstract-lazy-object-3d';
import { appliedMaterial } from '../../util';
import { fixCenter } from '../../util/fix-center';
import { RendererService } from '../../renderer/renderer.service';
export class TextMeshComponent extends AbstractLazyObject3D {
    /**
     * @param {?} rendererService
     */
    constructor(rendererService) {
        super(rendererService);
        this.rendererService = rendererService;
        this.material = 'basic';
        this._materialColor = 0xDADADA;
        this._text = 'Text';
        this.size = 10;
        this.height = 0.3;
        this.curveSegments = 2;
        this.bevelEnabled = false;
        this.bevelThickness = 0.1;
        this.bevelSize = 0.1;
        this.bevelOffset = 0;
        this.bevelSegments = 1;
        this.fontUrl = './assets/font/helvetiker_regular.typeface.json';
        this.castShadow = true;
        this.receiveShadow = true;
        this.depthWrite = true;
        this.centered = true;
    }
    /**
     * @param {?} materialColor
     * @return {?}
     */
    set materialColor(materialColor) {
        // console.log('change color', materialColor);
        this._materialColor = materialColor;
        this.startLoading();
    }
    /**
     * @return {?}
     */
    get materialColor() {
        return this._materialColor;
    }
    /**
     * @param {?} text
     * @return {?}
     */
    set text(text) {
        this._text = text;
        this.startLoading();
    }
    /**
     * @return {?}
     */
    get text() {
        return this._text;
    }
    /**
     * @return {?}
     */
    getMaterial() {
        return appliedMaterial(this.materialColor, this.material, this.depthWrite);
    }
    /**
     * @protected
     * @return {?}
     */
    loadLazyObject() {
        return tslib_1.__awaiter(this, void 0, void 0, /** @this {!TextMeshComponent} */ function* () {
            // console.log('TextMeshComponent.loadLazyObject');
            return new Promise((/**
             * @param {?} resolve
             * @return {?}
             */
            resolve => {
                /** @type {?} */
                const loader = new THREE.FontLoader();
                loader.load(this.fontUrl, (/**
                 * @param {?} font
                 * @return {?}
                 */
                font => {
                    /** @type {?} */
                    const geometry = new THREE.TextGeometry(this.text, {
                        font: font,
                        size: this.size,
                        height: this.height,
                        curveSegments: this.curveSegments,
                        bevelEnabled: this.bevelEnabled,
                        bevelThickness: this.bevelThickness,
                        bevelSize: this.bevelSize,
                        bevelOffset: this.bevelOffset,
                        bevelSegments: this.bevelOffset
                    });
                    /** @type {?} */
                    const material = this.getMaterial();
                    /** @type {?} */
                    const mesh = new THREE.Mesh(geometry, material);
                    mesh.castShadow = this.castShadow;
                    mesh.receiveShadow = this.receiveShadow;
                    if (this.centered) {
                        fixCenter(mesh);
                    }
                    resolve(mesh);
                }));
            }));
        });
    }
}
TextMeshComponent.decorators = [
    { type: Component, args: [{
                selector: 'atft-text-mesh',
                providers: [{ provide: AbstractObject3D, useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => TextMeshComponent)) }],
                template: '<ng-content></ng-content>'
            }] }
];
/** @nocollapse */
TextMeshComponent.ctorParameters = () => [
    { type: RendererService }
];
TextMeshComponent.propDecorators = {
    material: [{ type: Input }],
    materialColor: [{ type: Input }],
    text: [{ type: Input }],
    size: [{ type: Input }],
    height: [{ type: Input }],
    curveSegments: [{ type: Input }],
    bevelEnabled: [{ type: Input }],
    bevelThickness: [{ type: Input }],
    bevelSize: [{ type: Input }],
    bevelOffset: [{ type: Input }],
    bevelSegments: [{ type: Input }],
    fontUrl: [{ type: Input }],
    castShadow: [{ type: Input }],
    receiveShadow: [{ type: Input }],
    depthWrite: [{ type: Input }],
    centered: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    TextMeshComponent.prototype.material;
    /**
     * @type {?}
     * @private
     */
    TextMeshComponent.prototype._materialColor;
    /**
     * @type {?}
     * @private
     */
    TextMeshComponent.prototype._text;
    /** @type {?} */
    TextMeshComponent.prototype.size;
    /** @type {?} */
    TextMeshComponent.prototype.height;
    /** @type {?} */
    TextMeshComponent.prototype.curveSegments;
    /** @type {?} */
    TextMeshComponent.prototype.bevelEnabled;
    /** @type {?} */
    TextMeshComponent.prototype.bevelThickness;
    /** @type {?} */
    TextMeshComponent.prototype.bevelSize;
    /** @type {?} */
    TextMeshComponent.prototype.bevelOffset;
    /** @type {?} */
    TextMeshComponent.prototype.bevelSegments;
    /** @type {?} */
    TextMeshComponent.prototype.fontUrl;
    /** @type {?} */
    TextMeshComponent.prototype.castShadow;
    /** @type {?} */
    TextMeshComponent.prototype.receiveShadow;
    /** @type {?} */
    TextMeshComponent.prototype.depthWrite;
    /** @type {?} */
    TextMeshComponent.prototype.centered;
    /**
     * @type {?}
     * @protected
     */
    TextMeshComponent.prototype.rendererService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dC1tZXNoLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2F0ZnQvIiwic291cmNlcyI6WyJsaWIvb2JqZWN0L3RleHQvdGV4dC1tZXNoLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUMzRCxPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMvQixPQUFPLEVBQUMsZ0JBQWdCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUN2RCxPQUFPLEVBQUMsb0JBQW9CLEVBQUMsTUFBTSw0QkFBNEIsQ0FBQztBQUNoRSxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQzNDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUNoRCxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0saUNBQWlDLENBQUM7QUFPaEUsTUFBTSxPQUFPLGlCQUFrQixTQUFRLG9CQUFvQjs7OztJQW1FekQsWUFDWSxlQUFnQztRQUUxQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7UUFGYixvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFqRTVDLGFBQVEsR0FBRyxPQUFPLENBQUM7UUFHWCxtQkFBYyxHQUFHLFFBQVEsQ0FBQztRQVcxQixVQUFLLEdBQUcsTUFBTSxDQUFDO1FBWXZCLFNBQUksR0FBRyxFQUFFLENBQUM7UUFHVixXQUFNLEdBQUcsR0FBRyxDQUFDO1FBR2Isa0JBQWEsR0FBRyxDQUFDLENBQUM7UUFHbEIsaUJBQVksR0FBRyxLQUFLLENBQUM7UUFHckIsbUJBQWMsR0FBRyxHQUFHLENBQUM7UUFHckIsY0FBUyxHQUFHLEdBQUcsQ0FBQztRQUdoQixnQkFBVyxHQUFHLENBQUMsQ0FBQztRQUdoQixrQkFBYSxHQUFHLENBQUMsQ0FBQztRQUdsQixZQUFPLEdBQUcsZ0RBQWdELENBQUM7UUFH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TCxLQUFLO3lCQUdMLEtBQUs7dUJBR0wsS0FBSzs7OztJQTlETixxQ0FDbUI7Ozs7O0lBR25CLDJDQUFrQzs7Ozs7SUFXbEMsa0NBQXVCOztJQVd2QixpQ0FDVTs7SUFFVixtQ0FDYTs7SUFFYiwwQ0FDa0I7O0lBRWxCLHlDQUNxQjs7SUFFckIsMkNBQ3FCOztJQUVyQixzQ0FDZ0I7O0lBRWhCLHdDQUNnQjs7SUFFaEIsMENBQ2tCOztJQUVsQixvQ0FDMkQ7O0lBRTNELHVDQUNrQjs7SUFFbEIsMENBQ3FCOztJQUVyQix1Q0FDa0I7O0lBRWxCLHFDQUNnQjs7Ozs7SUFHZCw0Q0FBMEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbXBvbmVudCwgZm9yd2FyZFJlZiwgSW5wdXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7XHJcbmltcG9ydCB7QWJzdHJhY3RPYmplY3QzRH0gZnJvbSAnLi4vYWJzdHJhY3Qtb2JqZWN0LTNkJztcclxuaW1wb3J0IHtBYnN0cmFjdExhenlPYmplY3QzRH0gZnJvbSAnLi4vYWJzdHJhY3QtbGF6eS1vYmplY3QtM2QnO1xyXG5pbXBvcnQge2FwcGxpZWRNYXRlcmlhbH0gZnJvbSAnLi4vLi4vdXRpbCc7XHJcbmltcG9ydCB7Zml4Q2VudGVyfSBmcm9tICcuLi8uLi91dGlsL2ZpeC1jZW50ZXInO1xyXG5pbXBvcnQge1JlbmRlcmVyU2VydmljZX0gZnJvbSAnLi4vLi4vcmVuZGVyZXIvcmVuZGVyZXIuc2VydmljZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2F0ZnQtdGV4dC1tZXNoJyxcclxuICBwcm92aWRlcnM6IFt7cHJvdmlkZTogQWJzdHJhY3RPYmplY3QzRCwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gVGV4dE1lc2hDb21wb25lbnQpfV0sXHJcbiAgdGVtcGxhdGU6ICc8bmctY29udGVudD48L25nLWNvbnRlbnQ+J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgVGV4dE1lc2hDb21wb25lbnQgZXh0ZW5kcyBBYnN0cmFjdExhenlPYmplY3QzRCB7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgbWF0ZXJpYWwgPSAnYmFzaWMnO1xyXG5cclxuXHJcbiAgcHJpdmF0ZSBfbWF0ZXJpYWxDb2xvciA9IDB4REFEQURBO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IG1hdGVyaWFsQ29sb3IobWF0ZXJpYWxDb2xvcjogbnVtYmVyKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnY2hhbmdlIGNvbG9yJywgbWF0ZXJpYWxDb2xvcik7XHJcbiAgICB0aGlzLl9tYXRlcmlhbENvbG9yID0gbWF0ZXJpYWxDb2xvcjtcclxuICAgIHRoaXMuc3RhcnRMb2FkaW5nKCk7XHJcbiAgfVxyXG4gIGdldCBtYXRlcmlhbENvbG9yKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX21hdGVyaWFsQ29sb3I7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF90ZXh0ID0gJ1RleHQnO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IHRleHQodGV4dDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl90ZXh0ID0gdGV4dDtcclxuICAgIHRoaXMuc3RhcnRMb2FkaW5nKCk7XHJcbiAgfVxyXG4gIGdldCB0ZXh0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3RleHQ7XHJcbiAgfVxyXG5cclxuXHJcbiAgQElucHV0KClcclxuICBzaXplID0gMTA7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgaGVpZ2h0ID0gMC4zO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGN1cnZlU2VnbWVudHMgPSAyO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGJldmVsRW5hYmxlZCA9IGZhbHNlO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGJldmVsVGhpY2tuZXNzID0gMC4xO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGJldmVsU2l6ZSA9IDAuMTtcclxuXHJcbiAgQElucHV0KClcclxuICBiZXZlbE9mZnNldCA9IDA7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgYmV2ZWxTZWdtZW50cyA9IDE7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgZm9udFVybCA9ICcuL2Fzc2V0cy9mb250L2hlbHZldGlrZXJfcmVndWxhci50eXBlZmFjZS5qc29uJztcclxuXHJcbiAgQElucHV0KClcclxuICBjYXN0U2hhZG93ID0gdHJ1ZTtcclxuXHJcbiAgQElucHV0KClcclxuICByZWNlaXZlU2hhZG93ID0gdHJ1ZTtcclxuXHJcbiAgQElucHV0KClcclxuICBkZXB0aFdyaXRlID0gdHJ1ZTtcclxuXHJcbiAgQElucHV0KClcclxuICBjZW50ZXJlZCA9IHRydWU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJvdGVjdGVkIHJlbmRlcmVyU2VydmljZTogUmVuZGVyZXJTZXJ2aWNlXHJcbiAgKSB7XHJcbiAgICBzdXBlcihyZW5kZXJlclNlcnZpY2UpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldE1hdGVyaWFsKCk6IFRIUkVFLk1hdGVyaWFsIHtcclxuICAgIHJldHVybiBhcHBsaWVkTWF0ZXJpYWwodGhpcy5tYXRlcmlhbENvbG9yLCB0aGlzLm1hdGVyaWFsLCB0aGlzLmRlcHRoV3JpdGUpO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGFzeW5jIGxvYWRMYXp5T2JqZWN0KCk6IFByb21pc2U8VEhSRUUuT2JqZWN0M0Q+IHtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdUZXh0TWVzaENvbXBvbmVudC5sb2FkTGF6eU9iamVjdCcpO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTxUSFJFRS5PYmplY3QzRD4ocmVzb2x2ZSA9PiB7XHJcbiAgICAgIGNvbnN0IGxvYWRlciA9IG5ldyBUSFJFRS5Gb250TG9hZGVyKCk7XHJcbiAgICAgIGxvYWRlci5sb2FkKHRoaXMuZm9udFVybCwgZm9udCA9PiB7XHJcblxyXG4gICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLlRleHRHZW9tZXRyeSh0aGlzLnRleHQsIHtcclxuICAgICAgICAgIGZvbnQ6IGZvbnQsXHJcbiAgICAgICAgICBzaXplOiB0aGlzLnNpemUsXHJcbiAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0LFxyXG4gICAgICAgICAgY3VydmVTZWdtZW50czogdGhpcy5jdXJ2ZVNlZ21lbnRzLFxyXG4gICAgICAgICAgYmV2ZWxFbmFibGVkOiB0aGlzLmJldmVsRW5hYmxlZCxcclxuICAgICAgICAgIGJldmVsVGhpY2tuZXNzOiB0aGlzLmJldmVsVGhpY2tuZXNzLFxyXG4gICAgICAgICAgYmV2ZWxTaXplOiB0aGlzLmJldmVsU2l6ZSxcclxuICAgICAgICAgIGJldmVsT2Zmc2V0OiB0aGlzLmJldmVsT2Zmc2V0LFxyXG4gICAgICAgICAgYmV2ZWxTZWdtZW50czogdGhpcy5iZXZlbE9mZnNldFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5nZXRNYXRlcmlhbCgpO1xyXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG4gICAgICAgIG1lc2guY2FzdFNoYWRvdyA9IHRoaXMuY2FzdFNoYWRvdztcclxuICAgICAgICBtZXNoLnJlY2VpdmVTaGFkb3cgPSB0aGlzLnJlY2VpdmVTaGFkb3c7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNlbnRlcmVkKSB7XHJcbiAgICAgICAgICBmaXhDZW50ZXIobWVzaCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc29sdmUobWVzaCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICB9XHJcblxyXG5cclxufVxyXG4iXX0=