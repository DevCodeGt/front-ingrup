/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ContentChildren, EventEmitter, Input, Output, QueryList, ViewChildren } from '@angular/core';
/**
 * @abstract
 * @template T
 */
export class AbstractObject3D {
    /**
     * @param {?} rendererService
     */
    constructor(rendererService) {
        this.rendererService = rendererService;
        this.changed = new EventEmitter();
        // console.log('AbstractObject3D.constructor');
        this.changed.subscribe((/**
         * @return {?}
         */
        () => {
            this.rendererService.render();
        }));
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (!this.object) {
            return;
        }
        /** @type {?} */
        let modified = false;
        if (['rotateX', 'rotateY', 'rotateZ'].some((/**
         * @param {?} propName
         * @return {?}
         */
        propName => propName in changes))) {
            this.applyRotation();
            modified = true;
        }
        if (['translateX', 'translateY', 'translateZ'].some((/**
         * @param {?} propName
         * @return {?}
         */
        propName => propName in changes))) {
            this.applyTranslation();
            modified = true;
        }
        if (modified) {
            this.changed.emit();
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        // console.log('AbstractObject3D.OnDestroy');
        if (this.object && this.object.parent) {
            this.object.parent.remove(this.object);
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // console.log('AbstractObject3D.ngAfterViewInit ' + this.name);
        this.object = this.newObject3DInstance();
        this.applyTranslation();
        this.applyRotation();
        this.collectChilds();
        this.afterInit();
    }
    /**
     * @return {?}
     */
    collectChilds() {
        // console.log('Collect childs for', this.name);
        if (this.childNodes !== undefined && this.childNodes.length > 1) {
            this.childNodes.filter((/**
             * @param {?} i
             * @return {?}
             */
            i => i !== this && i.getObject() !== undefined)).forEach((/**
             * @param {?} i
             * @return {?}
             */
            i => {
                // console.log('Add childNodes for', this.name, i);
                this.addChild(i.getObject());
            }));
        }
        else {
            // console.log("No child Object3D for: " + this.constructor.label);
        }
        if (this.viewChilds !== undefined && this.viewChilds.length > 0) {
            this.viewChilds.filter((/**
             * @param {?} i
             * @return {?}
             */
            i => i !== this
                && i.getObject() !== undefined
                && !i.getObject().parent /* direct childs only */)).forEach((/**
             * @param {?} i
             * @return {?}
             */
            i => {
                // console.log('Add viewChilds for', this.name, i);
                this.addChild(i.getObject());
            }));
        }
        else {
            // console.log("No child Object3D for: " + this.constructor.label);
        }
    }
    /**
     * @private
     * @return {?}
     */
    applyRotation() {
        this.object.rotation.set(this.rotateX || 0, this.rotateY || 0, this.rotateZ || 0, 'XYZ');
    }
    /**
     * @private
     * @return {?}
     */
    applyTranslation() {
        this.object.position.set(this.translateX || 0, this.translateY || 0, this.translateZ || 0);
    }
    /**
     * @param {?} object
     * @return {?}
     */
    addChild(object) {
        this.object.add(object);
    }
    /**
     * @protected
     * @param {?} object
     * @return {?}
     */
    removeChild(object) {
        this.object.remove(object);
    }
    /**
     * @return {?}
     */
    getObject() {
        return this.object;
    }
    /**
     * @protected
     * @return {?}
     */
    afterInit() {
        // this.changed.emit();
    }
}
AbstractObject3D.propDecorators = {
    childNodes: [{ type: ContentChildren, args: [AbstractObject3D, { descendants: false },] }],
    viewChilds: [{ type: ViewChildren, args: [AbstractObject3D,] }],
    rotateX: [{ type: Input }],
    rotateY: [{ type: Input }],
    rotateZ: [{ type: Input }],
    translateX: [{ type: Input }],
    translateY: [{ type: Input }],
    translateZ: [{ type: Input }],
    name: [{ type: Input }],
    changed: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    AbstractObject3D.prototype.childNodes;
    /** @type {?} */
    AbstractObject3D.prototype.viewChilds;
    /**
     * Rotation in Euler angles (radians) with order X, Y, Z.
     * @type {?}
     */
    AbstractObject3D.prototype.rotateX;
    /** @type {?} */
    AbstractObject3D.prototype.rotateY;
    /** @type {?} */
    AbstractObject3D.prototype.rotateZ;
    /**
     * Translate the geometry. This is typically done as a one time operation, and not during a loop.
     * @type {?}
     */
    AbstractObject3D.prototype.translateX;
    /** @type {?} */
    AbstractObject3D.prototype.translateY;
    /** @type {?} */
    AbstractObject3D.prototype.translateZ;
    /** @type {?} */
    AbstractObject3D.prototype.name;
    /** @type {?} */
    AbstractObject3D.prototype.changed;
    /**
     * @type {?}
     * @private
     */
    AbstractObject3D.prototype.object;
    /**
     * @type {?}
     * @protected
     */
    AbstractObject3D.prototype.rendererService;
    /**
     * @abstract
     * @protected
     * @return {?}
     */
    AbstractObject3D.prototype.newObject3DInstance = function () { };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWJzdHJhY3Qtb2JqZWN0LTNkLmpzIiwic291cmNlUm9vdCI6Im5nOi8vYXRmdC8iLCJzb3VyY2VzIjpbImxpYi9vYmplY3QvYWJzdHJhY3Qtb2JqZWN0LTNkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBRUwsZUFBZSxFQUNmLFlBQVksRUFDWixLQUFLLEVBR0wsTUFBTSxFQUNOLFNBQVMsRUFFVCxZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7Ozs7O0FBSXZCLE1BQU0sT0FBZ0IsZ0JBQWdCOzs7O0lBMEJwQyxZQUFzQixlQUFnQztRQUFoQyxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFKNUMsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFRLENBQUM7UUFLM0MsK0NBQStDO1FBQy9DLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUzs7O1FBQUMsR0FBRyxFQUFFO1lBQzFCLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDaEMsQ0FBQyxFQUFDLENBQUM7SUFFTCxDQUFDOzs7OztJQUVNLFdBQVcsQ0FBQyxPQUFzQjtRQUN2QyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNoQixPQUFPO1NBQ1I7O1lBRUcsUUFBUSxHQUFHLEtBQUs7UUFFcEIsSUFBSSxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDLENBQUMsSUFBSTs7OztRQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsUUFBUSxJQUFJLE9BQU8sRUFBQyxFQUFFO1lBQzNFLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUNyQixRQUFRLEdBQUcsSUFBSSxDQUFDO1NBQ2pCO1FBQ0QsSUFBSSxDQUFDLFlBQVksRUFBRSxZQUFZLEVBQUUsWUFBWSxDQUFDLENBQUMsSUFBSTs7OztRQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsUUFBUSxJQUFJLE9BQU8sRUFBQyxFQUFFO1lBQ3BGLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQ3hCLFFBQVEsR0FBRyxJQUFJLENBQUM7U0FDakI7UUFFRCxJQUFJLFFBQVEsRUFBRTtZQUNaLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7U0FDckI7SUFFSCxDQUFDOzs7O0lBRU0sV0FBVztRQUNoQiw2Q0FBNkM7UUFDN0MsSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO1lBQ3JDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDeEM7SUFDSCxDQUFDOzs7O0lBRU0sZUFBZTtRQUNwQixnRUFBZ0U7UUFDaEUsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztRQUV6QyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFckIsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBRXJCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNuQixDQUFDOzs7O0lBRU0sYUFBYTtRQUNsQixnREFBZ0Q7UUFDaEQsSUFBSSxJQUFJLENBQUMsVUFBVSxLQUFLLFNBQVMsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDL0QsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsQ0FBQyxTQUFTLEVBQUUsS0FBSyxTQUFTLEVBQUMsQ0FBQyxPQUFPOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ2pGLG1EQUFtRDtnQkFDbkQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQztZQUMvQixDQUFDLEVBQUMsQ0FBQztTQUNKO2FBQU07WUFDTCxtRUFBbUU7U0FDcEU7UUFHRCxJQUFJLElBQUksQ0FBQyxVQUFVLEtBQUssU0FBUyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUMvRCxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU07Ozs7WUFDcEIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssSUFBSTttQkFDVixDQUFDLENBQUMsU0FBUyxFQUFFLEtBQUssU0FBUzttQkFDM0IsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsTUFBTSxDQUFDLHdCQUF3QixFQUNwRCxDQUFDLE9BQU87Ozs7WUFBQyxDQUFDLENBQUMsRUFBRTtnQkFDWixtREFBbUQ7Z0JBQ25ELElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7WUFDL0IsQ0FBQyxFQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsbUVBQW1FO1NBQ3BFO0lBRUgsQ0FBQzs7Ozs7SUFHTyxhQUFhO1FBQ25CLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FDdEIsSUFBSSxDQUFDLE9BQU8sSUFBSSxDQUFDLEVBQ2pCLElBQUksQ0FBQyxPQUFPLElBQUksQ0FBQyxFQUNqQixJQUFJLENBQUMsT0FBTyxJQUFJLENBQUMsRUFDakIsS0FBSyxDQUNOLENBQUM7SUFDSixDQUFDOzs7OztJQUVPLGdCQUFnQjtRQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQ3RCLElBQUksQ0FBQyxVQUFVLElBQUksQ0FBQyxFQUNwQixJQUFJLENBQUMsVUFBVSxJQUFJLENBQUMsRUFDcEIsSUFBSSxDQUFDLFVBQVUsSUFBSSxDQUFDLENBQ3JCLENBQUM7SUFDSixDQUFDOzs7OztJQUVNLFFBQVEsQ0FBQyxNQUFzQjtRQUNwQyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUMxQixDQUFDOzs7Ozs7SUFFUyxXQUFXLENBQUMsTUFBc0I7UUFDMUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDN0IsQ0FBQzs7OztJQUVNLFNBQVM7UUFDZCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDckIsQ0FBQzs7Ozs7SUFFUyxTQUFTO1FBQ2pCLHVCQUF1QjtJQUN6QixDQUFDOzs7eUJBcElBLGVBQWUsU0FBQyxnQkFBZ0IsRUFBRSxFQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUM7eUJBRXRELFlBQVksU0FBQyxnQkFBZ0I7c0JBSzdCLEtBQUs7c0JBQ0wsS0FBSztzQkFDTCxLQUFLO3lCQUtMLEtBQUs7eUJBQ0wsS0FBSzt5QkFDTCxLQUFLO21CQUVMLEtBQUs7c0JBRUwsTUFBTTs7OztJQXBCUCxzQ0FBaUg7O0lBRWpILHNDQUF3Rjs7Ozs7SUFLeEYsbUNBQXlCOztJQUN6QixtQ0FBeUI7O0lBQ3pCLG1DQUF5Qjs7Ozs7SUFLekIsc0NBQTRCOztJQUM1QixzQ0FBNEI7O0lBQzVCLHNDQUE0Qjs7SUFFNUIsZ0NBQXNCOztJQUV0QixtQ0FBNkM7Ozs7O0lBRTdDLGtDQUFrQjs7Ozs7SUFFTiwyQ0FBMEM7Ozs7OztJQThHdEQsaUVBQTRDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBBZnRlclZpZXdJbml0LFxyXG4gIENvbnRlbnRDaGlsZHJlbixcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgSW5wdXQsXHJcbiAgT25DaGFuZ2VzLFxyXG4gIE9uRGVzdHJveSxcclxuICBPdXRwdXQsXHJcbiAgUXVlcnlMaXN0LFxyXG4gIFNpbXBsZUNoYW5nZXMsXHJcbiAgVmlld0NoaWxkcmVuXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJztcclxuaW1wb3J0IHtSZW5kZXJlclNlcnZpY2V9IGZyb20gJy4uL3JlbmRlcmVyL3JlbmRlcmVyLnNlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0T2JqZWN0M0Q8VCBleHRlbmRzIFRIUkVFLk9iamVjdDNEPiBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcclxuXHJcbiAgQENvbnRlbnRDaGlsZHJlbihBYnN0cmFjdE9iamVjdDNELCB7ZGVzY2VuZGFudHM6IGZhbHNlfSkgY2hpbGROb2RlczogUXVlcnlMaXN0PEFic3RyYWN0T2JqZWN0M0Q8VEhSRUUuT2JqZWN0M0Q+PjtcclxuXHJcbiAgQFZpZXdDaGlsZHJlbihBYnN0cmFjdE9iamVjdDNEKSB2aWV3Q2hpbGRzOiBRdWVyeUxpc3Q8QWJzdHJhY3RPYmplY3QzRDxUSFJFRS5PYmplY3QzRD4+O1xyXG5cclxuICAvKipcclxuICAgKiBSb3RhdGlvbiBpbiBFdWxlciBhbmdsZXMgKHJhZGlhbnMpIHdpdGggb3JkZXIgWCwgWSwgWi5cclxuICAgKi9cclxuICBASW5wdXQoKSByb3RhdGVYOiBudW1iZXI7XHJcbiAgQElucHV0KCkgcm90YXRlWTogbnVtYmVyO1xyXG4gIEBJbnB1dCgpIHJvdGF0ZVo6IG51bWJlcjtcclxuXHJcbiAgLyoqXHJcbiAgICogVHJhbnNsYXRlIHRoZSBnZW9tZXRyeS4gVGhpcyBpcyB0eXBpY2FsbHkgZG9uZSBhcyBhIG9uZSB0aW1lIG9wZXJhdGlvbiwgYW5kIG5vdCBkdXJpbmcgYSBsb29wLlxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIHRyYW5zbGF0ZVg6IG51bWJlcjtcclxuICBASW5wdXQoKSB0cmFuc2xhdGVZOiBudW1iZXI7XHJcbiAgQElucHV0KCkgdHJhbnNsYXRlWjogbnVtYmVyO1xyXG5cclxuICBASW5wdXQoKSBuYW1lOiBzdHJpbmc7XHJcblxyXG4gIEBPdXRwdXQoKSBjaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xyXG5cclxuICBwcml2YXRlIG9iamVjdDogVDtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHJlbmRlcmVyU2VydmljZTogUmVuZGVyZXJTZXJ2aWNlKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnQWJzdHJhY3RPYmplY3QzRC5jb25zdHJ1Y3RvcicpO1xyXG4gICAgdGhpcy5jaGFuZ2VkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXJTZXJ2aWNlLnJlbmRlcigpO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgIGlmICghdGhpcy5vYmplY3QpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBtb2RpZmllZCA9IGZhbHNlO1xyXG5cclxuICAgIGlmIChbJ3JvdGF0ZVgnLCAncm90YXRlWScsICdyb3RhdGVaJ10uc29tZShwcm9wTmFtZSA9PiBwcm9wTmFtZSBpbiBjaGFuZ2VzKSkge1xyXG4gICAgICB0aGlzLmFwcGx5Um90YXRpb24oKTtcclxuICAgICAgbW9kaWZpZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgaWYgKFsndHJhbnNsYXRlWCcsICd0cmFuc2xhdGVZJywgJ3RyYW5zbGF0ZVonXS5zb21lKHByb3BOYW1lID0+IHByb3BOYW1lIGluIGNoYW5nZXMpKSB7XHJcbiAgICAgIHRoaXMuYXBwbHlUcmFuc2xhdGlvbigpO1xyXG4gICAgICBtb2RpZmllZCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG1vZGlmaWVkKSB7XHJcbiAgICAgIHRoaXMuY2hhbmdlZC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nT25EZXN0cm95KCkge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ0Fic3RyYWN0T2JqZWN0M0QuT25EZXN0cm95Jyk7XHJcbiAgICBpZiAodGhpcy5vYmplY3QgJiYgdGhpcy5vYmplY3QucGFyZW50KSB7XHJcbiAgICAgIHRoaXMub2JqZWN0LnBhcmVudC5yZW1vdmUodGhpcy5vYmplY3QpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgIC8vIGNvbnNvbGUubG9nKCdBYnN0cmFjdE9iamVjdDNELm5nQWZ0ZXJWaWV3SW5pdCAnICsgdGhpcy5uYW1lKTtcclxuICAgIHRoaXMub2JqZWN0ID0gdGhpcy5uZXdPYmplY3QzREluc3RhbmNlKCk7XHJcblxyXG4gICAgdGhpcy5hcHBseVRyYW5zbGF0aW9uKCk7XHJcbiAgICB0aGlzLmFwcGx5Um90YXRpb24oKTtcclxuXHJcbiAgICB0aGlzLmNvbGxlY3RDaGlsZHMoKTtcclxuXHJcbiAgICB0aGlzLmFmdGVySW5pdCgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNvbGxlY3RDaGlsZHMoKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZygnQ29sbGVjdCBjaGlsZHMgZm9yJywgdGhpcy5uYW1lKTtcclxuICAgIGlmICh0aGlzLmNoaWxkTm9kZXMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmNoaWxkTm9kZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICB0aGlzLmNoaWxkTm9kZXMuZmlsdGVyKGkgPT4gaSAhPT0gdGhpcyAmJiBpLmdldE9iamVjdCgpICE9PSB1bmRlZmluZWQpLmZvckVhY2goaSA9PiB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0FkZCBjaGlsZE5vZGVzIGZvcicsIHRoaXMubmFtZSwgaSk7XHJcbiAgICAgICAgdGhpcy5hZGRDaGlsZChpLmdldE9iamVjdCgpKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyhcIk5vIGNoaWxkIE9iamVjdDNEIGZvcjogXCIgKyB0aGlzLmNvbnN0cnVjdG9yLmxhYmVsKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgaWYgKHRoaXMudmlld0NoaWxkcyAhPT0gdW5kZWZpbmVkICYmIHRoaXMudmlld0NoaWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMudmlld0NoaWxkcy5maWx0ZXIoXHJcbiAgICAgICAgaSA9PiBpICE9PSB0aGlzXHJcbiAgICAgICAgICAmJiBpLmdldE9iamVjdCgpICE9PSB1bmRlZmluZWRcclxuICAgICAgICAgICYmICFpLmdldE9iamVjdCgpLnBhcmVudCAvKiBkaXJlY3QgY2hpbGRzIG9ubHkgKi9cclxuICAgICAgKS5mb3JFYWNoKGkgPT4ge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdBZGQgdmlld0NoaWxkcyBmb3InLCB0aGlzLm5hbWUsIGkpO1xyXG4gICAgICAgIHRoaXMuYWRkQ2hpbGQoaS5nZXRPYmplY3QoKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gY29uc29sZS5sb2coXCJObyBjaGlsZCBPYmplY3QzRCBmb3I6IFwiICsgdGhpcy5jb25zdHJ1Y3Rvci5sYWJlbCk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIHByaXZhdGUgYXBwbHlSb3RhdGlvbigpOiB2b2lkIHtcclxuICAgIHRoaXMub2JqZWN0LnJvdGF0aW9uLnNldChcclxuICAgICAgdGhpcy5yb3RhdGVYIHx8IDAsXHJcbiAgICAgIHRoaXMucm90YXRlWSB8fCAwLFxyXG4gICAgICB0aGlzLnJvdGF0ZVogfHwgMCxcclxuICAgICAgJ1hZWidcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFwcGx5VHJhbnNsYXRpb24oKTogdm9pZCB7XHJcbiAgICB0aGlzLm9iamVjdC5wb3NpdGlvbi5zZXQoXHJcbiAgICAgIHRoaXMudHJhbnNsYXRlWCB8fCAwLFxyXG4gICAgICB0aGlzLnRyYW5zbGF0ZVkgfHwgMCxcclxuICAgICAgdGhpcy50cmFuc2xhdGVaIHx8IDBcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYWRkQ2hpbGQob2JqZWN0OiBUSFJFRS5PYmplY3QzRCk6IHZvaWQge1xyXG4gICAgdGhpcy5vYmplY3QuYWRkKG9iamVjdCk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgcmVtb3ZlQ2hpbGQob2JqZWN0OiBUSFJFRS5PYmplY3QzRCk6IHZvaWQge1xyXG4gICAgdGhpcy5vYmplY3QucmVtb3ZlKG9iamVjdCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0T2JqZWN0KCk6IFQge1xyXG4gICAgcmV0dXJuIHRoaXMub2JqZWN0O1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGFmdGVySW5pdCgpIHtcclxuICAgIC8vIHRoaXMuY2hhbmdlZC5lbWl0KCk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgYWJzdHJhY3QgbmV3T2JqZWN0M0RJbnN0YW5jZSgpOiBUO1xyXG5cclxuXHJcbn1cclxuIl19