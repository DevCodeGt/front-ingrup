/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, forwardRef, Input } from '@angular/core';
import * as THREE from 'three';
import { AbstractObject3D } from '../abstract-object-3d';
import { MeshLine, MeshLineMaterial } from 'three.meshline';
import { AbstractConnector } from './abstract-connector';
import { appliedColor } from '../../util/applied-color';
import { AnimationService } from '../../animation/animation.service';
import { RendererService } from '../../renderer/renderer.service';
export class MeshLineConnectorComponent extends AbstractConnector {
    /**
     * @param {?} animationService
     * @param {?} rendererService
     */
    constructor(animationService, rendererService) {
        super(rendererService);
        this.animationService = animationService;
        this.rendererService = rendererService;
        this.materialColor = 0xffff00;
        this.transparent = true;
        this.opacity = 0.5;
        this.lineWidth = 0.5;
        this.depthWrite = true;
        this.depthTest = true;
        this.animated = false;
        this.animationIncrement = 0.002;
    }
    /**
     * @return {?}
     */
    createConnectorObject() {
        this.geometry = this.getLineGeometry();
        this.line = new MeshLine();
        this.line.setGeometry(this.geometry);
        this.lineMaterial = (this.animated ?
            new MeshLineMaterial({
                color: appliedColor(this.materialColor),
                transparent: this.transparent,
                opacity: this.opacity,
                lineWidth: this.lineWidth,
                depthWrite: this.depthWrite,
                depthTest: this.depthTest,
                side: THREE.DoubleSide,
                blending: THREE.NormalBlending,
                // TODO: props
                dashArray: 0.05,
                dashOffset: 0.1,
                dashRatio: 0.1
            })
            : new MeshLineMaterial({
                color: appliedColor(this.materialColor),
                transparent: this.transparent,
                opacity: this.opacity,
                lineWidth: this.lineWidth,
                depthWrite: this.depthWrite,
                depthTest: this.depthTest,
                side: THREE.DoubleSide,
                blending: THREE.NormalBlending
            }));
        /** @type {?} */
        const mesh = new THREE.Mesh(this.line.geometry, this.lineMaterial);
        if (this.animated) {
            this.animate = this.animate.bind(this);
            this.animationService.animate.subscribe(this.animate);
        }
        return mesh;
    }
    /**
     * @private
     * @return {?}
     */
    animate() {
        this.lineMaterial.uniforms.dashOffset.value += this.animationIncrement;
    }
    /**
     * @return {?}
     */
    updateLineGeometry() {
        // https://github.com/spite/THREE.MeshLine/issues/51#issuecomment-379579926
        this.line.setGeometry(this.geometry);
        this.rendererService.render();
    }
}
MeshLineConnectorComponent.decorators = [
    { type: Component, args: [{
                selector: 'atft-mesh-line-connector',
                providers: [{ provide: AbstractObject3D, useExisting: forwardRef((/**
                         * @return {?}
                         */
                        () => MeshLineConnectorComponent)) }],
                template: '<ng-content></ng-content>'
            }] }
];
/** @nocollapse */
MeshLineConnectorComponent.ctorParameters = () => [
    { type: AnimationService },
    { type: RendererService }
];
MeshLineConnectorComponent.propDecorators = {
    materialColor: [{ type: Input }],
    transparent: [{ type: Input }],
    opacity: [{ type: Input }],
    lineWidth: [{ type: Input }],
    depthWrite: [{ type: Input }],
    depthTest: [{ type: Input }],
    animated: [{ type: Input }],
    animationIncrement: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    MeshLineConnectorComponent.prototype.materialColor;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.transparent;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.opacity;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.lineWidth;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.depthWrite;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.depthTest;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.animated;
    /** @type {?} */
    MeshLineConnectorComponent.prototype.animationIncrement;
    /**
     * @type {?}
     * @private
     */
    MeshLineConnectorComponent.prototype.geometry;
    /**
     * @type {?}
     * @private
     */
    MeshLineConnectorComponent.prototype.line;
    /**
     * @type {?}
     * @private
     */
    MeshLineConnectorComponent.prototype.lineMaterial;
    /**
     * @type {?}
     * @protected
     */
    MeshLineConnectorComponent.prototype.animationService;
    /**
     * @type {?}
     * @protected
     */
    MeshLineConnectorComponent.prototype.rendererService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzaC1saW5lLWNvbm5lY3Rvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hdGZ0LyIsInNvdXJjZXMiOlsibGliL29iamVjdC9jb25uZWN0b3IvbWVzaC1saW5lLWNvbm5lY3Rvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUMzRCxPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMvQixPQUFPLEVBQUMsZ0JBQWdCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUN2RCxPQUFPLEVBQUMsUUFBUSxFQUFFLGdCQUFnQixFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDMUQsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDdkQsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLDBCQUEwQixDQUFDO0FBQ3RELE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLG1DQUFtQyxDQUFDO0FBQ25FLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxpQ0FBaUMsQ0FBQztBQU9oRSxNQUFNLE9BQU8sMEJBQTJCLFNBQVEsaUJBQTZCOzs7OztJQThCM0UsWUFDWSxnQkFBa0MsRUFDbEMsZUFBZ0M7UUFFMUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBSGIscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUNsQyxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUE3QjVDLGtCQUFhLEdBQUcsUUFBUSxDQUFDO1FBR3pCLGdCQUFXLEdBQUcsSUFBSSxDQUFDO1FBR25CLFlBQU8sR0FBRyxHQUFHLENBQUM7UUFHZCxjQUFTLEdBQUcsR0FBRyxDQUFDO1FBR2hCLGVBQVUsR0FBRyxJQUFJLENBQUM7UUFHbEIsY0FBUyxHQUFHLElBQUksQ0FBQztRQUdqQixhQUFRLEdBQUcsS0FBSyxDQUFDO1FBRVIsdUJB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Qk4sbURBQ3lCOztJQUV6QixpREFDbUI7O0lBRW5CLDZDQUNjOztJQUVkLCtDQUNnQjs7SUFFaEIsZ0RBQ2tCOztJQUVsQiwrQ0FDaUI7O0lBRWpCLDhDQUNpQjs7SUFFakIsd0RBQW9DOzs7OztJQUVwQyw4Q0FBaUM7Ozs7O0lBQ2pDLDBDQUF1Qjs7Ozs7SUFDdkIsa0RBQXVDOzs7OztJQUlyQyxzREFBNEM7Ozs7O0lBQzVDLHFEQUEwQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBmb3J3YXJkUmVmLCBJbnB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJztcclxuaW1wb3J0IHtBYnN0cmFjdE9iamVjdDNEfSBmcm9tICcuLi9hYnN0cmFjdC1vYmplY3QtM2QnO1xyXG5pbXBvcnQge01lc2hMaW5lLCBNZXNoTGluZU1hdGVyaWFsfSBmcm9tICd0aHJlZS5tZXNobGluZSc7XHJcbmltcG9ydCB7QWJzdHJhY3RDb25uZWN0b3J9IGZyb20gJy4vYWJzdHJhY3QtY29ubmVjdG9yJztcclxuaW1wb3J0IHthcHBsaWVkQ29sb3J9IGZyb20gJy4uLy4uL3V0aWwvYXBwbGllZC1jb2xvcic7XHJcbmltcG9ydCB7QW5pbWF0aW9uU2VydmljZX0gZnJvbSAnLi4vLi4vYW5pbWF0aW9uL2FuaW1hdGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHtSZW5kZXJlclNlcnZpY2V9IGZyb20gJy4uLy4uL3JlbmRlcmVyL3JlbmRlcmVyLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhdGZ0LW1lc2gtbGluZS1jb25uZWN0b3InLFxyXG4gIHByb3ZpZGVyczogW3twcm92aWRlOiBBYnN0cmFjdE9iamVjdDNELCB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNZXNoTGluZUNvbm5lY3RvckNvbXBvbmVudCl9XSxcclxuICB0ZW1wbGF0ZTogJzxuZy1jb250ZW50PjwvbmctY29udGVudD4nXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBNZXNoTGluZUNvbm5lY3RvckNvbXBvbmVudCBleHRlbmRzIEFic3RyYWN0Q29ubmVjdG9yPFRIUkVFLk1lc2g+IHtcclxuXHJcbiAgQElucHV0KClcclxuICBtYXRlcmlhbENvbG9yID0gMHhmZmZmMDA7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgdHJhbnNwYXJlbnQgPSB0cnVlO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIG9wYWNpdHkgPSAwLjU7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgbGluZVdpZHRoID0gMC41O1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGRlcHRoV3JpdGUgPSB0cnVlO1xyXG5cclxuICBASW5wdXQoKVxyXG4gIGRlcHRoVGVzdCA9IHRydWU7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgYW5pbWF0ZWQgPSBmYWxzZTtcclxuXHJcbiAgQElucHV0KCkgYW5pbWF0aW9uSW5jcmVtZW50ID0gMC4wMDI7XHJcblxyXG4gIHByaXZhdGUgZ2VvbWV0cnk6IFRIUkVFLkdlb21ldHJ5O1xyXG4gIHByaXZhdGUgbGluZTogTWVzaExpbmU7XHJcbiAgcHJpdmF0ZSBsaW5lTWF0ZXJpYWw6IE1lc2hMaW5lTWF0ZXJpYWw7XHJcblxyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByb3RlY3RlZCBhbmltYXRpb25TZXJ2aWNlOiBBbmltYXRpb25TZXJ2aWNlLFxyXG4gICAgcHJvdGVjdGVkIHJlbmRlcmVyU2VydmljZTogUmVuZGVyZXJTZXJ2aWNlXHJcbiAgKSB7XHJcbiAgICBzdXBlcihyZW5kZXJlclNlcnZpY2UpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ29ubmVjdG9yT2JqZWN0KCk6IFRIUkVFLk1lc2gge1xyXG4gICAgdGhpcy5nZW9tZXRyeSA9IHRoaXMuZ2V0TGluZUdlb21ldHJ5KCk7XHJcblxyXG4gICAgdGhpcy5saW5lID0gbmV3IE1lc2hMaW5lKCk7XHJcbiAgICB0aGlzLmxpbmUuc2V0R2VvbWV0cnkodGhpcy5nZW9tZXRyeSk7XHJcblxyXG4gICAgdGhpcy5saW5lTWF0ZXJpYWwgPSAodGhpcy5hbmltYXRlZCA/XHJcbiAgICAgICAgbmV3IE1lc2hMaW5lTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgY29sb3I6IGFwcGxpZWRDb2xvcih0aGlzLm1hdGVyaWFsQ29sb3IpLFxyXG4gICAgICAgICAgdHJhbnNwYXJlbnQ6IHRoaXMudHJhbnNwYXJlbnQsXHJcbiAgICAgICAgICBvcGFjaXR5OiB0aGlzLm9wYWNpdHksXHJcbiAgICAgICAgICBsaW5lV2lkdGg6IHRoaXMubGluZVdpZHRoLFxyXG4gICAgICAgICAgZGVwdGhXcml0ZTogdGhpcy5kZXB0aFdyaXRlLFxyXG4gICAgICAgICAgZGVwdGhUZXN0OiB0aGlzLmRlcHRoVGVzdCxcclxuICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsXHJcbiAgICAgICAgICBibGVuZGluZzogVEhSRUUuTm9ybWFsQmxlbmRpbmcsXHJcbiAgICAgICAgICAvLyBUT0RPOiBwcm9wc1xyXG4gICAgICAgICAgZGFzaEFycmF5OiAwLjA1LFxyXG4gICAgICAgICAgZGFzaE9mZnNldDogMC4xLFxyXG4gICAgICAgICAgZGFzaFJhdGlvOiAwLjFcclxuICAgICAgICB9KVxyXG4gICAgICAgIDogbmV3IE1lc2hMaW5lTWF0ZXJpYWwoe1xyXG4gICAgICAgICAgY29sb3I6IGFwcGxpZWRDb2xvcih0aGlzLm1hdGVyaWFsQ29sb3IpLFxyXG4gICAgICAgICAgdHJhbnNwYXJlbnQ6IHRoaXMudHJhbnNwYXJlbnQsXHJcbiAgICAgICAgICBvcGFjaXR5OiB0aGlzLm9wYWNpdHksXHJcbiAgICAgICAgICBsaW5lV2lkdGg6IHRoaXMubGluZVdpZHRoLFxyXG4gICAgICAgICAgZGVwdGhXcml0ZTogdGhpcy5kZXB0aFdyaXRlLFxyXG4gICAgICAgICAgZGVwdGhUZXN0OiB0aGlzLmRlcHRoVGVzdCxcclxuICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsXHJcbiAgICAgICAgICBibGVuZGluZzogVEhSRUUuTm9ybWFsQmxlbmRpbmdcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2godGhpcy5saW5lLmdlb21ldHJ5LCB0aGlzLmxpbmVNYXRlcmlhbCk7XHJcbiAgICBpZiAodGhpcy5hbmltYXRlZCkge1xyXG4gICAgICB0aGlzLmFuaW1hdGUgPSB0aGlzLmFuaW1hdGUuYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5hbmltYXRpb25TZXJ2aWNlLmFuaW1hdGUuc3Vic2NyaWJlKHRoaXMuYW5pbWF0ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVzaDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYW5pbWF0ZSgpIHtcclxuICAgIHRoaXMubGluZU1hdGVyaWFsLnVuaWZvcm1zLmRhc2hPZmZzZXQudmFsdWUgKz0gdGhpcy5hbmltYXRpb25JbmNyZW1lbnQ7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaW5lR2VvbWV0cnkoKTogdm9pZCB7XHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc3BpdGUvVEhSRUUuTWVzaExpbmUvaXNzdWVzLzUxI2lzc3VlY29tbWVudC0zNzk1Nzk5MjZcclxuICAgIHRoaXMubGluZS5zZXRHZW9tZXRyeSh0aGlzLmdlb21ldHJ5KTtcclxuICAgIHRoaXMucmVuZGVyZXJTZXJ2aWNlLnJlbmRlcigpO1xyXG4gIH1cclxuXHJcbn1cclxuIl19